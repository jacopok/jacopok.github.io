<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model for waveform generation &mdash; mlgw_bns 0.0.2-alpha.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Management of a training and validation dataset" href="dataset_generation.html" />
    <link rel="prev" title="Package reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> mlgw_bns
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage_guides/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage_guides/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage_guides/profiling.html">Profiling the model evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Package reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Model for waveform generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataset_generation.html">Management of a training and validation dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="downsampling_interpolation.html">Downsampling and interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_management.html">Data management</a></li>
<li class="toctree-l2"><a class="reference internal" href="principal_component_analysis.html">Principal Component Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyperparameter_optimization.html">Hyperparameter Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_validation.html">Model Validation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mlgw_bns</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Package reference</a> &raquo;</li>
      <li>Model for waveform generation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/package_reference/model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-mlgw_bns.model">
<span id="model-for-waveform-generation"></span><h1>Model for waveform generation<a class="headerlink" href="#module-mlgw_bns.model" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mlgw_bns.model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_frequency_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srate_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4096.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_components_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="dataset_generation.html#mlgw_bns.dataset_generation.WaveformGenerator" title="mlgw_bns.dataset_generation.WaveformGenerator"><span class="pre">mlgw_bns.dataset_generation.WaveformGenerator</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="downsampling_interpolation.html#mlgw_bns.downsampling_interpolation.DownsamplingTraining" title="mlgw_bns.downsampling_interpolation.DownsamplingTraining"><span class="pre">mlgw_bns.downsampling_interpolation.DownsamplingTraining</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model" title="Permalink to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">mlgw_bns</span></code> model.
This class incorporates all the functionality required to
compute the downsampling indices, train a PCA model,
train a neural network and predict new waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name for the model. Saved data will be saved under this name.</p></li>
<li><p><strong>initial_frequency_hz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – Initial frequency for the waveforms, by default 20.0</p></li>
<li><p><strong>srate_hz</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – Time-domain signal rate for the waveforms,
which is twice the maximum frequency of
their frequency-domain version.
By default 4096.0</p></li>
<li><p><strong>pca_components_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Number of PCA components to use when reducing
the dimensionality of the dataset.
By default 30, which is high enough to reach extremely good
reconstruction accuracy (mismatches smaller than <span class="math notranslate nohighlight">\(10^{-8}\)</span>).</p></li>
<li><p><strong>waveform_generator</strong> (<a class="reference internal" href="dataset_generation.html#mlgw_bns.dataset_generation.WaveformGenerator" title="mlgw_bns.dataset_generation.WaveformGenerator"><em>WaveformGenerator</em></a><em>, </em><em>optional</em>) – Generator for the waveforms to be used in the training;
by default None, in which case the system attempts to import
the Python wrapper for TEOBResumS, failing which a <code class="xref py py-class docutils literal notranslate"><span class="pre">BareBarePostNewtonianGenerator</span></code>
is used, which is unable to generate effective-one-body waveforms.</p></li>
<li><p><strong>downsampling_training</strong> (<a class="reference internal" href="downsampling_interpolation.html#mlgw_bns.downsampling_interpolation.DownsamplingTraining" title="mlgw_bns.downsampling_interpolation.DownsamplingTraining"><em>DownsamplingTraining</em></a><em>, </em><em>optional</em>) – Training algorithm for the downsampling;
by default None, which means the greedy algorithm
implemented in <code class="xref py py-class docutils literal notranslate"><span class="pre">GreedyDownsamplingTraining</span></code> is used.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.file_arrays">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">file_arrays</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">h5py._hl.files.File</span></em><a class="headerlink" href="#mlgw_bns.model.Model.file_arrays" title="Permalink to this definition"></a></dt>
<dd><p>File object in which to save datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>file</strong> – To be used as a context manager.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.5)">h5py.File</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.filename_hyper">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filename_hyper</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></em><a class="headerlink" href="#mlgw_bns.model.Model.filename_hyper" title="Permalink to this definition"></a></dt>
<dd><p>File name in which to save the hyperparameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.filename_nn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filename_nn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></em><a class="headerlink" href="#mlgw_bns.model.Model.filename_nn" title="Permalink to this definition"></a></dt>
<dd><p>File name in which to save the neural network.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_downsampling_dataset_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_pca_dataset_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_nn_dataset_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.generate" title="Permalink to this definition"></a></dt>
<dd><p>Generate a new model from scratch.</p>
<p>The parameters are the sizes of the three datasets to be used when training,
if they are set to None they are not computed and the pre-existing values are used instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.10)"><strong>AssertionError</strong></a> – If one of the parameters is set to None but no
    pre-existing data is availabele for it.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>training_downsampling_dataset_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – By default 64.</p></li>
<li><p><strong>training_pca_dataset_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – By default 256.</p></li>
<li><p><strong>training_nn_dataset_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – By default 256.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">streams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.IO" title="(in Python v3.10)"><span class="pre">typing.IO</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.IO" title="(in Python v3.10)"><span class="pre">typing.IO</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.IO" title="(in Python v3.10)"><span class="pre">typing.IO</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.load" title="Permalink to this definition"></a></dt>
<dd><p>Load model from the files present in the current folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>streams</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>[</em><em>IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><em>bytes</em></a><em>]</em><em>, </em><em>IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><em>bytes</em></a><em>]</em><em>, </em><em>IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.10)"><em>bytes</em></a><em>]</em><em>]</em><em>, </em><em>optional</em>) – For internal use (specifically, loading the default model).
Defaults to None (look in the current folder).</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.pca_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pca_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="principal_component_analysis.html#mlgw_bns.principal_component_analysis.PrincipalComponentAnalysisModel" title="mlgw_bns.principal_component_analysis.PrincipalComponentAnalysisModel"><span class="pre">mlgw_bns.principal_component_analysis.PrincipalComponentAnalysisModel</span></a></em><a class="headerlink" href="#mlgw_bns.model.Model.pca_model" title="Permalink to this definition"></a></dt>
<dd><p>PCA model to be used for dimensionality reduction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="principal_component_analysis.html#mlgw_bns.principal_component_analysis.PrincipalComponentAnalysisModel" title="mlgw_bns.principal_component_analysis.PrincipalComponentAnalysisModel">PrincipalComponentAnalysisModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mlgw_bns.model.ExtendedWaveformParameters" title="mlgw_bns.model.ExtendedWaveformParameters"><span class="pre">mlgw_bns.model.ExtendedWaveformParameters</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.predict" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the waveforms in the plus and cross polarizations,
accounting for extrinsic parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frequencies</strong> (<em>np.ndarray</em>) – Frequencies where to compute the waveform, in Hz.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="#mlgw_bns.model.ExtendedWaveformParameters" title="mlgw_bns.model.ExtendedWaveformParameters"><em>ExtendedWaveformParameters</em></a>) – Parameters, both intrinsic and extrinsic.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Plus and cross-polarized waveforms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>hp, hc (complex np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.predict_residuals_bulk">
<span class="sig-name descname"><span class="pre">predict_residuals_bulk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">mlgw_bns.dataset_generation.ParameterSet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html#sklearn.neural_network.MLPRegressor" title="(in scikit-learn v1.0)"><span class="pre">sklearn.neural_network._multilayer_perceptron.MLPRegressor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><span class="pre">mlgw_bns.model.Hyperparameters</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="data_management.html#mlgw_bns.data_management.Residuals" title="mlgw_bns.data_management.Residuals"><span class="pre">mlgw_bns.data_management.Residuals</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.predict_residuals_bulk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.predict_residuals_bulk" title="Permalink to this definition"></a></dt>
<dd><p>Make a prediction for a set of different parameters,
using a network provided as a parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ParameterSet</em>) – Parameters of the residuals to reconstruct.</p></li>
<li><p><strong>nn</strong> (<em>MLPRegressor</em>) – Neural network to use for the reconstruction</p></li>
<li><p><strong>hyper</strong> (<a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><em>Hyperparameters</em></a>) – Used just for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Hyperparameters.pc_exponent</span></code> attribute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prediction through the model plus PCA.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="data_management.html#mlgw_bns.data_management.Residuals" title="mlgw_bns.data_management.Residuals">Residuals</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.reduced_residuals">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reduced_residuals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#mlgw_bns.model.Model.reduced_residuals" title="Permalink to this definition"></a></dt>
<dd><p>Reduced-dimensionality residuals
— in other words, PCA components —
corresponding to the <code class="xref py py-attr docutils literal notranslate"><span class="pre">training_dataset</span></code>.</p>
<p>This attribute is cached.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.save_arrays">
<span class="sig-name descname"><span class="pre">save_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_training_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.save_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.save_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Save all big arrays contained in this object to the file
defined as <code class="docutils literal notranslate"><span class="pre">{filename}.h5</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.set_hyper_and_train_nn">
<span class="sig-name descname"><span class="pre">set_hyper_and_train_nn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><span class="pre">mlgw_bns.model.Hyperparameters</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.set_hyper_and_train_nn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.set_hyper_and_train_nn" title="Permalink to this definition"></a></dt>
<dd><p>Train the network according to the hyperparameters given,
and set it as a class attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hyper</strong> (<a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><em>Hyperparameters</em></a><em>, </em><em>optional</em>) – Hyperparameters to use when training the network, by default None.
If not given, the default is to fall back to the standard set of hyperparameters
provided with the module.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.train_nn">
<span class="sig-name descname"><span class="pre">train_nn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hyper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><span class="pre">mlgw_bns.model.Hyperparameters</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.10)"><span class="pre">slice</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html#sklearn.neural_network.MLPRegressor" title="(in scikit-learn v1.0)"><span class="pre">sklearn.neural_network._multilayer_perceptron.MLPRegressor</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.train_nn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.train_nn" title="Permalink to this definition"></a></dt>
<dd><p>Train a</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hyper</strong> (<a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><em>Hyperparameters</em></a>) – Hyperparameters to be used in the initialization
of the network.</p></li>
<li><p><strong>indices</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.10)"><em>slice</em></a><em>]</em><em>, </em><em>optional</em>) – Indices used to perform a selection of a subsection
of the training data; by default <code class="docutils literal notranslate"><span class="pre">slice(None)</span></code>
which means all available training data is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trained network.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>MLPRegressor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Model.train_parameter_scaler">
<span class="sig-name descname"><span class="pre">train_parameter_scaler</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Model.train_parameter_scaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Model.train_parameter_scaler" title="Permalink to this definition"></a></dt>
<dd><p>Train the parameter scaler, which takes the
waveform parameters and makes their magnitudes similar
in order to aid the training of the network.</p>
<p>The parameter scaler is always trained on all the available dataset.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlgw_bns.model.Hyperparameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc_exponent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_no_change</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Dataclass containing the parameters which are passed to
the neural network for training, as well as a few more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pc_exponent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Exponent to be used in the normalization of the
principal components: the network learns to reconstruct
<span class="math notranslate nohighlight">\(x_i \lambda_i^\alpha\)</span>, where
<span class="math notranslate nohighlight">\(x_i\)</span> are the principal-component
representation of a waveform, while
<span class="math notranslate nohighlight">\(\lambda_i\)</span> are the eigenvalues of the PCA
and finally <span class="math notranslate nohighlight">\(\alpha\)</span> is this parameter.</p></li>
<li><p><strong>n_train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Number of waveforms to use in the training.</p></li>
<li><p><strong>hidden_layer_sizes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>...</em><em>]</em>) – Sizes of the layers in the neural network.
For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Activation function.
For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Regularization parameter.
For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>learning_rate_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>validation_fraction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
<li><p><strong>n_iter_no_change</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – For more details, refer to the documentation
of the <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mlgw_bns.model.Hyperparameters.from_trial">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_trial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">optuna.trial._trial.Trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_train_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlgw_bns/model.html#Hyperparameters.from_trial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.Hyperparameters.from_trial" title="Permalink to this definition"></a></dt>
<dd><p>Generate the hyperparameter set starting from an
<code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.Trial</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trial</strong> (<em>optuna.Trial</em>) – Used to generate the parameters.</p></li>
<li><p><strong>n_train_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Upper bound for the attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">n_train</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.Hyperparameters.nn_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nn_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mlgw_bns.model.Hyperparameters.nn_params" title="Permalink to this definition"></a></dt>
<dd><p>Return a dictionary which can be readily unpacked
and used to initialize a <code class="xref py py-class docutils literal notranslate"><span class="pre">MLPRegressor</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mlgw_bns.model.ExtendedWaveformParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ExtendedWaveformParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mass_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataset_generation.html#mlgw_bns.dataset_generation.Dataset" title="mlgw_bns.dataset_generation.Dataset"><span class="pre">mlgw_bns.dataset_generation.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_mpc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_phase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlgw_bns/model.html#ExtendedWaveformParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.ExtendedWaveformParameters" title="Permalink to this definition"></a></dt>
<dd><p>Subclass of <code class="xref py py-class docutils literal notranslate"><span class="pre">WaveformParameters</span></code>.
This class includes all the intrinsic parameters contained
there, as well as certain extrinsic parameters.</p>
<p>It is the standard interface with which to predict waveforms
with the <a class="reference internal" href="#mlgw_bns.model.Model" title="mlgw_bns.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance_mpc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Distance to the compact binary, in Megaparsecs.</p></li>
<li><p><strong>inclination</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Inclination of the binary, in radians:
angle between its orbital angular momentum
and the observation direction.</p></li>
<li><p><strong>reference_phase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Global phase to be added.</p></li>
<li><p><strong>time_shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Time shift, in seconds: it corresponds to a linear phase term to be added.</p></li>
<li><p><strong>total_mass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Total mass of the binary system, in solar masses.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.ExtendedWaveformParameters.mass_sum_seconds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_sum_seconds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#mlgw_bns.model.ExtendedWaveformParameters.mass_sum_seconds" title="Permalink to this definition"></a></dt>
<dd><p>Return the total mass of the system, <code class="xref py py-attr docutils literal notranslate"><span class="pre">total_mass</span></code>,
measured in seconds (<span class="math notranslate nohighlight">\(GM / c^3\)</span>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mlgw_bns.model.ExtendedWaveformParameters.teobresums">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">teobresums</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">typing.Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mlgw_bns.model.ExtendedWaveformParameters.teobresums" title="Permalink to this definition"></a></dt>
<dd><p>Parameter dictionary in a format compatible with
TEOBResumS.</p>
<p>The parameters are all converted to natural units.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlgw_bns.model.compute_polarizations">
<span class="sig-name descname"><span class="pre">compute_polarizations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_plus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_cross</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)"><span class="pre">complex</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#compute_polarizations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.compute_polarizations" title="Permalink to this definition"></a></dt>
<dd><p>Compute the two polarizations of the waveform,
assuming they are the same but for a differerent prefactor
(which is the case for compact binary coalescences).</p>
<p>This function is separated out so that it can be decorated with
<a class="reference external" href="https://numba.pydata.org/numba-doc/latest/reference/jit-compilation.html">numba.njit</a>
which allows it to be compiled — this can speed up the computation somewhat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waveform</strong> (<em>np.ndarray</em>) – Cartesian complex-valued waveform.</p></li>
<li><p><strong>pre_plus</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)"><em>complex</em></a>) – Complex-valued prefactor for the plus polarization of the waveform.</p></li>
<li><p><strong>pre_cross</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.10)"><em>complex</em></a>) – Complex-valued prefactor for the cross polarization of the waveform.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Plus and cross polarizations: complex-valued arrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a>[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlgw_bns.model.retrieve_best_trials_list">
<span class="sig-name descname"><span class="pre">retrieve_best_trials_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">optuna.trial._frozen.FrozenTrial</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#retrieve_best_trials_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.retrieve_best_trials_list" title="Permalink to this definition"></a></dt>
<dd><p>Read the list of best trials which is provided
with the package.</p>
<p>This list’s location can be found at the location
defined by <code class="docutils literal notranslate"><span class="pre">TRIALS_FILE</span></code>;
if one wishes to modify it, a new one can be generated
with the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">save_best_trials_to_file()</span></code> of the
class <a class="reference internal" href="hyperparameter_optimization.html#mlgw_bns.hyperparameter_optimization.HyperparameterOptimization" title="mlgw_bns.hyperparameter_optimization.HyperparameterOptimization"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlgw_bns.hyperparameter_optimization.HyperparameterOptimization</span></code></a>
after an optimization job has been run.</p>
<p>The current trials provided are the result of about 30 hours
of optimization on a laptop.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of the trials in the Pareto front of an optimization.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>[<a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.trial.FrozenTrial.html#optuna.trial.FrozenTrial" title="(in Optuna v2.10.0)">optuna.trial.FrozenTrial</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlgw_bns.model.best_trial_under_n">
<span class="sig-name descname"><span class="pre">best_trial_under_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">optuna.trial._frozen.FrozenTrial</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters"><span class="pre">mlgw_bns.model.Hyperparameters</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#best_trial_under_n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.best_trial_under_n" title="Permalink to this definition"></a></dt>
<dd><p>Utility function to retrieve
a set of hyperparameters starting from a list of optimization trials.
The best trial in terms of accuracy is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_trials</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>[</em><a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.trial.FrozenTrial.html#optuna.trial.FrozenTrial" title="(in Optuna v2.10.0)"><em>optuna.trial.FrozenTrial</em></a><em>]</em>) – List of trials in the Pareto front of an optimization run.
A default value for such a list is the one provided by
<a class="reference internal" href="#mlgw_bns.model.retrieve_best_trials_list" title="mlgw_bns.model.retrieve_best_trials_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">retrieve_best_trials_list()</span></code></a>.</p></li>
<li><p><strong>training_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Return the best trial obtained while using less than this number
of training waveforms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hyperparameters corresponding to the best trial found.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#mlgw_bns.model.Hyperparameters" title="mlgw_bns.model.Hyperparameters">Hyperparameters</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlgw_bns.model.cartesian_waveforms_at_frequencies">
<span class="sig-name descname"><span class="pre">cartesian_waveforms_at_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">waveforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data_management.html#mlgw_bns.data_management.FDWaveforms" title="mlgw_bns.data_management.FDWaveforms"><span class="pre">mlgw_bns.data_management.FDWaveforms</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_frequencies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataset_generation.html#mlgw_bns.dataset_generation.Dataset" title="mlgw_bns.dataset_generation.Dataset"><span class="pre">mlgw_bns.dataset_generation.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_training</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="downsampling_interpolation.html#mlgw_bns.downsampling_interpolation.DownsamplingTraining" title="mlgw_bns.downsampling_interpolation.DownsamplingTraining"><span class="pre">mlgw_bns.downsampling_interpolation.DownsamplingTraining</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="data_management.html#mlgw_bns.data_management.DownsamplingIndices" title="mlgw_bns.data_management.DownsamplingIndices"><span class="pre">mlgw_bns.data_management.DownsamplingIndices</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#cartesian_waveforms_at_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.cartesian_waveforms_at_frequencies" title="Permalink to this definition"></a></dt>
<dd><p>Starting from an array of downsampled waveforms decomposed into
amplitude and phase, interpolate them to a new frequency grid and
put them in Cartesian form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>waveforms</strong> (<a class="reference internal" href="data_management.html#mlgw_bns.data_management.FDWaveforms" title="mlgw_bns.data_management.FDWaveforms"><em>FDWaveforms</em></a>) – Waveforms to put in Cartesian form.</p></li>
<li><p><strong>new_frequencies</strong> (<em>np.ndarray</em>) – Frequencies to resample to, in natural units.</p></li>
<li><p><strong>dataset</strong> (<a class="reference internal" href="dataset_generation.html#mlgw_bns.dataset_generation.Dataset" title="mlgw_bns.dataset_generation.Dataset"><em>Dataset</em></a>) – Reference dataset.</p></li>
<li><p><strong>downsampling_training</strong> (<a class="reference internal" href="downsampling_interpolation.html#mlgw_bns.downsampling_interpolation.DownsamplingTraining" title="mlgw_bns.downsampling_interpolation.DownsamplingTraining"><em>DownsamplingTraining</em></a>) – Training model for the downsampling, contains metadata needed for the resampling.</p></li>
<li><p><strong>downsampling_indices</strong> (<a class="reference internal" href="data_management.html#mlgw_bns.data_management.DownsamplingIndices" title="mlgw_bns.data_management.DownsamplingIndices"><em>DownsamplingIndices</em></a>) – Downsampling indices, needed for the resampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cartesian waveforms: complex array with shape
<code class="docutils literal notranslate"><span class="pre">(n_waveforms,</span> <span class="pre">len(new_frequencies))</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mlgw_bns.model.combine_amplitude_phase">
<span class="sig-name descname"><span class="pre">combine_amplitude_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23.dev0)"><span class="pre">numpy.ndarray</span></a></span></span><a class="reference internal" href="../_modules/mlgw_bns/model.html#combine_amplitude_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mlgw_bns.model.combine_amplitude_phase" title="Permalink to this definition"></a></dt>
<dd><p>Starting from arrays of amplitude <span class="math notranslate nohighlight">\(A\)</span> and phase <span class="math notranslate nohighlight">\(\phi\)</span>,
return the cartesian waveform <span class="math notranslate nohighlight">\(A e^{i \phi}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amp</strong> (<em>np.ndarray</em>) – Amplitude array.</p></li>
<li><p><strong>phi</strong> (<em>np.ndarray</em>) – Phase array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cartesian waveform.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Package reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dataset_generation.html" class="btn btn-neutral float-right" title="Management of a training and validation dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jacopo Tissino.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>